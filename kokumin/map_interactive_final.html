
<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>議員スタンスマップ</title>
  <script src="https://d3js.org/d3.v7.min.js"></script>
  <style>
    body {
      font-family: sans-serif;
      max-width: 960px;
      margin: 40px auto;
      padding: 20px;
    }
    svg {
      background: #f8f8f8;
      border: 1px solid #ccc;
    }
    select {
      font-size: 16px;
      padding: 4px 10px;
      margin-bottom: 10px;
    }
    .label {
      font-size: 5px;
      pointer-events: none;
    }
  
    .tooltip {
      position: absolute;
      background: white;
      border: 1px solid #999;
      padding: 5px 8px;
      font-size: 12px;
      pointer-events: none;
      display: none;
    }
    </style>
    
</head>
<body>
  <h2>議員スタンスマップ</h2>
  <p>議員のスタンスや関心の傾向を可視化した2種類のマップを切り替えて表示できます。</p>
  <label>マップの種類：
    <select id="mapType">
      <option value="ideology">🟦 表現スタイルマップ（語彙×構成）</option>
      <option value="combined">🟧 関心領域マップ（政策トピック分析）</option>
    </select>
  </label>
  <svg width="800" height="600"></svg>
<div class="tooltip" id="tooltip"></div>

  <script>
    const ideologyData = [{"議員名": "丹野みどり", "思想軸1": -0.15674086644620086, "思想軸2": 0.08140210889323393, "サイズ": 12.500781968545665}, {"議員名": "仙田晃宏", "思想軸1": -0.19894381615081774, "思想軸2": 0.08035293810071603, "サイズ": 15.979077324591888}, {"議員名": "伊藤孝恵", "思想軸1": -0.008100621215365608, "思想軸2": 0.3785012541562557, "サイズ": 29.997977432259223}, {"議員名": "円より子", "思想軸1": -0.34033700717608073, "思想軸2": -0.2133784655062396, "サイズ": 29.997987590980912}, {"議員名": "古川元久", "思想軸1": 0.3282915662499627, "思想軸2": -0.12629929674495827, "サイズ": 21.968547851860464}, {"議員名": "小竹凱", "思想軸1": -0.11754707798755727, "思想軸2": 0.2126429825898929, "サイズ": 15.617443874211748}, {"議員名": "岡野純子", "思想軸1": -0.13980694528466442, "思想軸2": 0.09729621602097935, "サイズ": 9.01574446114075}, {"議員名": "岸田光広", "思想軸1": 0.5647736929886148, "思想軸2": -0.17462566677824054, "サイズ": 18.360791994969883}, {"議員名": "川合孝典", "思想軸1": 0.025292951937593303, "思想軸2": 0.4551014874575428, "サイズ": 29.998191789853262}, {"議員名": "平岩征樹", "思想軸1": -0.17792951778726107, "思想軸2": 0.17516061698169466, "サイズ": 16.767676333380948}, {"議員名": "日野紗里亜", "思想軸1": -0.21854245328298585, "思想軸2": 0.10207143299302096, "サイズ": 10.880641506003991}, {"議員名": "村岡敏英", "思想軸1": -0.19517977069778858, "思想軸2": -0.08087084891382838, "サイズ": 29.997157020825536}, {"議員名": "森ようすけ", "思想軸1": 0.47296446509872275, "思想軸2": -0.26085888186315076, "サイズ": 16.994952123942074}, {"議員名": "榛葉賀津也", "思想軸1": -0.35114662269728614, "思想軸2": -0.2397121603284556, "サイズ": 29.99813848227934}, {"議員名": "橋本幹彦", "思想軸1": 0.6366129957207897, "思想軸2": -0.2804443265461405, "サイズ": 17.456336961280357}, {"議員名": "浅野哲", "思想軸1": -0.315886517202497, "思想軸2": -0.26938385644798724, "サイズ": 11.675038496492768}, {"議員名": "浜口誠", "思想軸1": 0.007698651236994421, "思想軸2": 0.4337432718459452, "サイズ": 29.99829318582308}, {"議員名": "浜野喜史", "思想軸1": 0.010243216440123252, "思想軸2": 0.42997118851681426, "サイズ": 17.72965896709332}, {"議員名": "深作ヘスス", "思想軸1": -0.1007128290588346, "思想軸2": 0.25398251846697056, "サイズ": 18.710268074204855}, {"議員名": "玉木雄一郎", "思想軸1": -0.29128063749045785, "思想軸2": -0.34838188500176015, "サイズ": 29.999088475248456}, {"議員名": "田中健", "思想軸1": 0.40276101534486247, "思想軸2": 0.12948226450497652, "サイズ": 29.99847642000663}, {"議員名": "田村まみ", "思想軸1": -0.33618967608951494, "思想軸2": -0.21546518603247394, "サイズ": 26.958253319820034}, {"議員名": "石井智恵", "思想軸1": -0.18593363107350308, "思想軸2": 0.04014465446556607, "サイズ": 22.19056543175872}, {"議員名": "礒﨑哲史", "思想軸1": -0.35683096948740367, "思想軸2": -0.2465619176827396, "サイズ": 29.997845526349696}, {"議員名": "福田徹", "思想軸1": 0.35806045167296036, "思想軸2": -0.2091861535276328, "サイズ": 15.439898818923677}, {"議員名": "福田玄", "思想軸1": 0.500575601427929, "思想軸2": -0.09850871523680518, "サイズ": 8.139071476623995}, {"議員名": "竹詰仁", "思想軸1": -0.30975543436326913, "思想軸2": -0.19188872545100652, "サイズ": 17.598173838236917}, {"議員名": "臼木秀剛", "思想軸1": -0.01270756712625161, "思想軸2": 0.39548076311718117, "サイズ": 29.93026241814553}, {"議員名": "舟山康江", "思想軸1": -0.3119119133389743, "思想軸2": -0.2387565544203805, "サイズ": 29.998400728931667}, {"議員名": "菊池大二郎", "思想軸1": -0.11789529622862695, "思想軸2": 0.23184982991554595, "サイズ": 18.98321704219709}, {"議員名": "西岡秀子", "思想軸1": -0.21769678307589835, "思想軸2": 0.030910779271572066, "サイズ": 29.9601584046615}, {"議員名": "西岡義高", "思想軸1": 0.45812125757633126, "思想軸2": 0.06479468503854573, "サイズ": 21.46191070005803}, {"議員名": "許斐亮太郎", "思想軸1": -0.15678047354787636, "思想軸2": 0.08360847435511028, "サイズ": 29.829517360548387}, {"議員名": "鈴木義弘", "思想軸1": 0.4249657526241628, "思想軸2": 0.007953237783828709, "サイズ": 29.998543567117228}, {"議員名": "長友慎治", "思想軸1": -0.09111150860548138, "思想軸2": -0.27940243406337184, "サイズ": 19.160812087626052}, {"議員名": "鳩山紀一郎", "思想軸1": 0.4247893310872975, "思想軸2": 0.03534921970612749, "サイズ": 19.743803567918214}];
    const combinedData = [{"議員名": "丹野みどり", "思想軸1": 0.16574917481545065, "思想軸2": -0.05074634795063784, "サイズ": 12.500781968545665}, {"議員名": "仙田晃宏", "思想軸1": 0.18450990603270936, "思想軸2": -0.28544063442435796, "サイズ": 15.979077324591888}, {"議員名": "伊藤孝恵", "思想軸1": 0.0021514967632501234, "思想軸2": 0.22851067804115044, "サイズ": 29.997977432259223}, {"議員名": "円より子", "思想軸1": 0.8038920402890937, "思想軸2": -0.0697962256863338, "サイズ": 29.997987590980912}, {"議員名": "古川元久", "思想軸1": -0.1621010591896799, "思想軸2": 0.37804538158599993, "サイズ": 21.968547851860464}, {"議員名": "小竹凱", "思想軸1": 0.18345902976779832, "思想軸2": -0.2615118035406558, "サイズ": 15.617443874211748}, {"議員名": "岡野純子", "思想軸1": 0.03212187446330195, "思想軸2": 0.19568871735369203, "サイズ": 9.01574446114075}, {"議員名": "岸田光広", "思想軸1": -0.37004136774431184, "思想軸2": -0.24663431233722274, "サイズ": 18.360791994969883}, {"議員名": "川合孝典", "思想軸1": -0.5241384504355977, "思想軸2": -0.5369505797901556, "サイズ": 29.998191789853262}, {"議員名": "平岩征樹", "思想軸1": 0.056719362355360174, "思想軸2": -0.32858971143576615, "サイズ": 16.767676333380948}, {"議員名": "日野紗里亜", "思想軸1": 0.13759759220553297, "思想軸2": -0.10498213344067323, "サイズ": 10.880641506003991}, {"議員名": "村岡敏英", "思想軸1": -0.2533801985090663, "思想軸2": 0.8354025737891663, "サイズ": 29.997157020825536}, {"議員名": "森ようすけ", "思想軸1": -0.38599822123656813, "思想軸2": -0.04405102662929271, "サイズ": 16.994952123942074}, {"議員名": "榛葉賀津也", "思想軸1": 0.8038970446044016, "思想軸2": -0.06979746302718286, "サイズ": 29.99813848227934}, {"議員名": "橋本幹彦", "思想軸1": -0.2514617010810517, "思想軸2": 0.4695838185787179, "サイズ": 17.456336961280357}, {"議員名": "浅野哲", "思想軸1": 0.06391977149488262, "思想軸2": 0.0057904509101741365, "サイズ": 11.675038496492768}, {"議員名": "浜口誠", "思想軸1": -0.5241404972364012, "思想軸2": -0.5369533230619228, "サイズ": 29.99829318582308}, {"議員名": "浜野喜史", "思想軸1": 0.2526724191815192, "思想軸2": 0.09606917491639577, "サイズ": 17.72965896709332}, {"議員名": "深作ヘスス", "思想軸1": 0.3081366112229879, "思想軸2": -0.23711097874705575, "サイズ": 18.710268074204855}, {"議員名": "玉木雄一郎", "思想軸1": -0.25339811763406894, "思想軸2": 0.8354563032909769, "サイズ": 29.999088475248456}, {"議員名": "田中健", "思想軸1": -0.12872484104412493, "思想軸2": 0.21083710446773174, "サイズ": 29.99847642000663}, {"議員名": "田村まみ", "思想軸1": 0.05292467035545386, "思想軸2": 0.18757337351930436, "サイズ": 26.958253319820034}, {"議員名": "石井智恵", "思想軸1": 0.4593279903254419, "思想軸2": -0.18907565552280095, "サイズ": 22.19056543175872}, {"議員名": "礒﨑哲史", "思想軸1": 0.8038873557046841, "思想軸2": -0.0697950209795983, "サイズ": 29.997845526349696}, {"議員名": "福田徹", "思想軸1": -0.13886350140074094, "思想軸2": 0.5245043171345177, "サイズ": 15.439898818923677}, {"議員名": "福田玄", "思想軸1": -0.08110473412522655, "思想軸2": 0.09017403094970931, "サイズ": 8.139071476623995}, {"議員名": "竹詰仁", "思想軸1": -0.08930680323639037, "思想軸2": -0.25200690841336415, "サイズ": 17.598173838236917}, {"議員名": "臼木秀剛", "思想軸1": -0.522772844549468, "思想軸2": -0.5351104552010233, "サイズ": 29.93026241814553}, {"議員名": "舟山康江", "思想軸1": 0.8039057083365331, "思想軸2": -0.06979967052270623, "サイズ": 29.998400728931667}, {"議員名": "菊池大二郎", "思想軸1": -0.09790361094453114, "思想軸2": -0.3464972266447002, "サイズ": 18.98321704219709}, {"議員名": "西岡秀子", "思想軸1": -0.5236283025215792, "思想軸2": -0.5359996987536964, "サイズ": 29.9601584046615}, {"議員名": "西岡義高", "思想軸1": -0.41119117308277336, "思想軸2": -0.32402396529441907, "サイズ": 21.46191070005803}, {"議員名": "許斐亮太郎", "思想軸1": 0.7983230047481272, "思想軸2": -0.06838312527140335, "サイズ": 29.829517360548387}, {"議員名": "鈴木義弘", "思想軸1": -0.2533930887030809, "思想軸2": 0.8354411609784773, "サイズ": 29.998543567117228}, {"議員名": "長友慎治", "思想軸1": -0.3939870983378866, "思想軸2": -0.08156306788724421, "サイズ": 19.160812087626052}, {"議員名": "鳩山紀一郎", "思想軸1": -0.3880947340590333, "思想軸2": -0.28105346756289745, "サイズ": 19.743803567918214}];

    const svg = d3.select("svg");
    const width = +svg.attr("width");
    const height = +svg.attr("height");
    const margin = { top: 20, right: 20, bottom: 60, left: 60 };
    const innerWidth = width - margin.left - margin.right;
    const innerHeight = height - margin.top - margin.bottom;

    const g = svg.append("g")
      .attr("transform", "translate(" + margin.left + "," + margin.top + ")");

    const xScale = d3.scaleLinear().range([0, innerWidth]);
    const yScale = d3.scaleLinear().range([innerHeight, 0]);

    const xAxis = g.append("g").attr("transform", "translate(0," + innerHeight + ")");
    const yAxis = g.append("g");

    xAxis.append("text")
      .attr("x", innerWidth / 2)
      .attr("y", 40)
      .attr("fill", "#000")
      .attr("text-anchor", "middle")
      .attr("font-size", "12px")
      .text("語彙スタイル軸（表現傾向）");

    yAxis.append("text")
      .attr("transform", "rotate(-90)")
      .attr("x", -innerHeight / 2)
      .attr("y", -45)
      .attr("fill", "#000")
      .attr("text-anchor", "middle")
      .attr("font-size", "12px")
      .text("構成・情緒軸（論理性 vs 感情性）");

    const pointGroup = g.append("g");

    
    const tooltip = d3.select("#tooltip");

    function showTooltip(event, d) {
      tooltip.style("display", "block")
        .style("left", (event.pageX + 10) + "px")
        .style("top", (event.pageY + 10) + "px")
        .html(`<strong>${d.議員名}</strong><br>
               思想軸1: ${d.思想軸1.toFixed(3)}<br>
               思想軸2: ${d.思想軸2.toFixed(3)}`);
    }

    function hideTooltip() {
      tooltip.style("display", "none");
    }

    function update(data, useSize = false) {
      xScale.domain(d3.extent(data, d => d.思想軸1)).nice();
      yScale.domain(d3.extent(data, d => d.思想軸2)).nice();
      xAxis.call(d3.axisBottom(xScale));
      yAxis.call(d3.axisLeft(yScale));
      const t = d3.transition().duration(750);

      const points = pointGroup.selectAll("circle").data(data, d => d.議員名);
      points.enter().append("circle")
        .attr("r", 0)
        .attr("fill", useSize ? "orange" : "steelblue")
        .on("mouseover", showTooltip)
        .on("mousemove", showTooltip)
        .on("mouseout", hideTooltip)
        .merge(points)
        .transition(t)
        .attr("r", d => useSize ? d.サイズ : 5)
        .attr("cx", d => xScale(d.思想軸1))
        .attr("cy", d => yScale(d.思想軸2));
      points.exit().remove();

      const labels = pointGroup.selectAll("text.label").data(data, d => d.議員名);
      labels.enter().append("text")
        .attr("class", "label")
        .merge(labels)
        .transition(t)
        .attr("x", d => xScale(d.思想軸1) + 6)
        .attr("y", d => yScale(d.思想軸2) + 4)
        .text(d => d.議員名);
      labels.exit().remove();
    }

    update(ideologyData, false);

    const zoom = d3.zoom()
      .scaleExtent([0.5, 10])
      .on("zoom", (event) => {
        g.attr("transform", event.transform);
      });
    svg.call(zoom);

    d3.select("#mapType").on("change", function () {
      const selected = this.value;
      if (selected === "combined") {
        update(combinedData, true);
        xAxis.select("text").text("トピック構成軸（関心の方向性）");
        yAxis.select("text").text("関心の多様性軸（主張の広がり）");
      } else {
        update(ideologyData, false);
        xAxis.select("text").text("語彙スタイル軸（表現傾向）");
        yAxis.select("text").text("構成・情緒軸（論理性 vs 感情性）");
      }
    });
  </script>
</body>
</html>
